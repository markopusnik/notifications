<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
    <!--<meta name="viewport" content="user-scalable=yes, initial-scale=1, maximum-scale=4, minimum-scale=0.2, width=device-width, height=device-height, target-densitydpi=device-dpi" />-->
    <title>PhoneGap Notifications</title>
</head>
<body>
    <div class="app">
        <h1>PhoneGap</h1>
        <div id="deviceready" class="blink">
            <p class="event listening">Connecting to Device</p>
            <p class="event received" onclick="window.plugin.notification.local.add({ message: 'Great app!' });">Device is Ready</p>
			<button onclick="btnNAdd()">Add</button>
			<button onclick="btnNCancel()">Stop</button>
			<button onclick="btnNCheck()">Check</button>			
			<a href="mailto:pusnik.marko@gmail.com?subject=notifications hello 1">Email Me!</a>
			<a href="mailto:?subject=&body=body body" target="_blank">Send email</a>
        </div>
    </div>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="local-notification.js"></script>
    <script type="text/javascript">

		var now                  = new Date().getTime(),
			_60_seconds_from_now = new Date(now + 60*1000);
	
		document.addEventListener('deviceready', function () {
		
			console.log("deviceready");

			window.plugin.notification.local.onadd = function (id, state, json) {
				console.log("Notification scheduled; id: " + id + "; state: " + state + "; json: " + json);
			};		
			
			window.plugin.notification.local.ontrigger = function (id, state, json) {
				console.log("Notification triggered; id: " + id + "; state: " + state + "; json: " + json);
			};		
			
			window.plugin.notification.local.onclick = function (id, state, json) {
				console.log("Notification clicked; id: " + id + "; state: " + state + "; json: " + json);
			};		
		
			window.plugin.notification.local.oncancel = function (id, state, json) {
				console.log("Notification canceled; id: " + id + "; state: " + state + "; json: " + json);
			};		
			
			window.plugin.notification.local.add({
				id:      1,
				title:   'App ready',
				message: 'Notification app loaded.',
				autoCancel: true
			});			
				
		}, false);

		function btnNAdd() {
			window.plugin.notification.local.add({
				id:      2,
				title:   'Reminder',
				message: 'Dont forget to buy some flowers.',
				repeat:  'minutely',
				date:    _60_seconds_from_now,
				json:    JSON.stringify({ test: 123 })
			});
		}
		
		function btnNCancel() {
			window.plugin.notification.local.cancelAll();
		}

		function btnNCheck() {
			window.plugin.notification.local.getScheduledIds( function (scheduledId) {
				console.log(scheduledId);
				window.plugin.notification.local.isScheduled(scheduledId, function (isScheduled) {
					 alert('Notification with ID ' + scheduledId + ' is scheduled: ' + isScheduled);
				});		
			});
		}

		</script>
</body>